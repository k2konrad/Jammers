<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jam Session Manager</title>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const JamSessionManager = () => {
          const [currentTime, setCurrentTime] = useState(new Date());
          const [startTime, setStartTime] = useState(null);
          const [endTime, setEndTime] = useState(null);
          const [settingTime, setSettingTime] = useState(null);
          const [sessionStarted, setSessionStarted] = useState(false);
          
          const instruments = [
            { name: 'Drums', icon: 'ðŸ¥', color: 'bg-purple-100' },
            { name: 'Guitar', icon: 'ðŸŽ¸', color: 'bg-blue-100' },
            { name: 'Bass', icon: 'ðŸŽ¸', color: 'bg-green-100' },
            { name: 'Vocal', icon: 'ðŸŽ¤', color: 'bg-pink-100' },
            { name: 'Piano', icon: 'ðŸŽ¹', color: 'bg-yellow-100' }
          ];
          
          const [performers, setPerformers] = useState({
            Drums: [],
            Guitar: [],
            Bass: [],
            Vocal: [],
            Piano: []
          });
          
          const [activePerformers, setActivePerformers] = useState({
            Drums: null,
            Guitar: null,
            Bass: null,
            Vocal: null,
            Piano: null
          });
          
          const [newPerformer, setNewPerformer] = useState({
            name: '',
            instrument: 'Drums'
          });

          useEffect(() => {
            const timer = setInterval(() => {
              setCurrentTime(new Date());
            }, 1000);
            return () => clearInterval(timer);
          }, []);

          const timeToAngle = (hours, minutes) => {
            const totalMinutes = hours * 60 + minutes;
            return (totalMinutes / (12 * 60)) * 360 - 90;
          };

          const angleToTime = (angle) => {
            const normalizedAngle = (angle + 90 + 360) % 360;
            const totalMinutes = (normalizedAngle / 360) * (12 * 60);
            const hours = Math.floor(totalMinutes / 60);
            const minutes = Math.round(totalMinutes % 60);
            return { hours, minutes };
          };

          const handleClockClick = (e) => {
            if (!settingTime) return;
            
            const rect = e.currentTarget.getBoundingClientRect();
            const centerX = rect.width / 2;
            const centerY = rect.height / 2;
            const x = e.clientX - rect.left - centerX;
            const y = e.clientY - rect.top - centerY;
            const angle = Math.atan2(y, x) * (180 / Math.PI);
            const time = angleToTime(angle);
            
            const now = new Date();
            const selectedTime = new Date(now);
            selectedTime.setHours(time.hours);
            selectedTime.setMinutes(time.minutes);
            selectedTime.setSeconds(0);
            
            if (settingTime === 'start') {
              setStartTime(selectedTime);
              setSessionStarted(true);
            } else {
              setEndTime(selectedTime);
            }
            setSettingTime(null);
          };

          const addPerformer = () => {
            if (!newPerformer.name.trim()) return;
            
            const performer = {
              id: Date.now(),
              name: newPerformer.name,
              entryTime: new Date(),
              timeOnStage: 0,
              status: 'waiting',
              startedAt: null
            };
            
            setPerformers(prev => ({
              ...prev,
              [newPerformer.instrument]: [...prev[newPerformer.instrument], performer]
            }));
            
            setNewPerformer({ name: '', instrument: newPerformer.instrument });
          };

          const toggleActive = (instrument) => {
            const queue = performers[instrument];
            const currentActive = activePerformers[instrument];
            
            if (currentActive !== null) {
              const updatedQueue = [...queue];
              const now = new Date();
              const timeSpent = Math.floor((now - updatedQueue[currentActive].startedAt) / 60000);
              updatedQueue[currentActive] = {
                ...updatedQueue[currentActive],
                status: 'finished',
                timeOnStage: updatedQueue[currentActive].timeOnStage + timeSpent
              };
              
              setPerformers(prev => ({
                ...prev,
                [instrument]: updatedQueue
              }));
              
              const nextWaiting = updatedQueue.findIndex((p, idx) => idx > currentActive && p.status === 'waiting');
              
              if (nextWaiting !== -1) {
                const newQueue = [...updatedQueue];
                newQueue[nextWaiting] = {
                  ...newQueue[nextWaiting],
                  status: 'active',
                  startedAt: new Date()
                };
                setPerformers(prev => ({
                  ...prev,
                  [instrument]: newQueue
                }));
                setActivePerformers(prev => ({
                  ...prev,
                  [instrument]: nextWaiting
                }));
              } else {
                setActivePerformers(prev => ({
                  ...prev,
                  [instrument]: null
                }));
              }
            } else {
              const nextWaiting = queue.findIndex(p => p.status === 'waiting');
              if (nextWaiting !== -1) {
                const updatedQueue = [...queue];
                updatedQueue[nextWaiting] = {
                  ...updatedQueue[nextWaiting],
                  status: 'active',
                  startedAt: new Date()
                };
                setPerformers(prev => ({
                  ...prev,
                  [instrument]: updatedQueue
                }));
                setActivePerformers(prev => ({
                  ...prev,
                  [instrument]: nextWaiting
                }));
              }
            }
          };

          const getStatusColor = (status) => {
            if (status === 'active') return 'bg-green-500';
            if (status === 'finished') return 'bg-red-500';
            return 'bg-gray-300';
          };

          const getNextPerformer = (instrument) => {
            const queue = performers[instrument];
            const current = activePerformers[instrument];
            if (current === null) {
              return queue.findIndex(p => p.status === 'waiting');
            }
            return queue.findIndex((p, idx) => idx > current && p.status === 'waiting');
          };

          const hours = currentTime.getHours() % 12;
          const minutes = currentTime.getMinutes();
          const seconds = currentTime.getSeconds();

          return (
            <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-8">
              <div className="max-w-7xl mx-auto">
                <h1 className="text-5xl font-bold text-white text-center mb-8">ðŸŽµ Jam Session Manager</h1>
                
                <div className="bg-white rounded-lg shadow-2xl p-8 mb-8">
                  <div className="flex justify-center mb-8">
                    <div className="relative">
                      <svg 
                        width="300" 
                        height="300" 
                        className="cursor-pointer"
                        onClick={handleClockClick}
                      >
                        <circle cx="150" cy="150" r="140" fill="white" stroke="#333" strokeWidth="4"/>
                        
                        {[...Array(12)].map((_, i) => {
                          const angle = (i * 30 - 90) * Math.PI / 180;
                          const x1 = 150 + 120 * Math.cos(angle);
                          const y1 = 150 + 120 * Math.sin(angle);
                          const x2 = 150 + 130 * Math.cos(angle);
                          const y2 = 150 + 130 * Math.sin(angle);
                          return (
                            <line key={i} x1={x1} y1={y1} x2={x2} y2={y2} stroke="#333" strokeWidth="2"/>
                          );
                        })}
                        
                        {[...Array(12)].map((_, i) => {
                          const angle = (i * 30 - 90) * Math.PI / 180;
                          const x = 150 + 100 * Math.cos(angle);
                          const y = 150 + 100 * Math.sin(angle);
                          return (
                            <text key={i} x={x} y={y} textAnchor="middle" dominantBaseline="middle" fontSize="20" fontWeight="bold">
                              {i === 0 ? 12 : i}
                            </text>
                          );
                        })}
                        
                        {startTime && (
                          <line
                            x1="150"
                            y1="150"
                            x2={150 + 130 * Math.cos(timeToAngle(startTime.getHours() % 12, startTime.getMinutes()) * Math.PI / 180)}
                            y2={150 + 130 * Math.sin(timeToAngle(startTime.getHours() % 12, startTime.getMinutes()) * Math.PI / 180)}
                            stroke="green"
                            strokeWidth="6"
                            strokeLinecap="round"
                          />
                        )}
                        
                        {endTime && (
                          <line
                            x1="150"
                            y1="150"
                            x2={150 + 130 * Math.cos(timeToAngle(endTime.getHours() % 12, endTime.getMinutes()) * Math.PI / 180)}
                            y2={150 + 130 * Math.sin(timeToAngle(endTime.getHours() % 12, endTime.getMinutes()) * Math.PI / 180)}
                            stroke="red"
                            strokeWidth="6"
                            strokeLinecap="round"
                          />
                        )}
                        
                        <line
                          x1="150"
                          y1="150"
                          x2={150 + 80 * Math.cos(timeToAngle(hours, minutes) * Math.PI / 180)}
                          y2={150 + 80 * Math.sin(timeToAngle(hours, minutes) * Math.PI / 180)}
                          stroke="#333"
                          strokeWidth="6"
                          strokeLinecap="round"
                        />
                        
                        <line
                          x1="150"
                          y1="150"
                          x2={150 + 110 * Math.cos(((minutes * 6 - 90) * Math.PI / 180))}
                          y2={150 + 110 * Math.sin(((minutes * 6 - 90) * Math.PI / 180))}
                          stroke="#666"
                          strokeWidth="4"
                          strokeLinecap="round"
                        />
                        
                        <circle cx="150" cy="150" r="8" fill="#333"/>
                      </svg>
                      
                      <div className="text-center mt-4">
                        <div className="text-3xl font-bold mb-4">
                          {currentTime.toLocaleTimeString()}
                        </div>
                        <div className="flex gap-2 justify-center">
                          <button
                            onClick={() => setSettingTime('start')}
                            className={`px-4 py-2 rounded ${settingTime === 'start' ? 'bg-green-600' : 'bg-green-500'} text-white font-bold hover:bg-green-600`}
                          >
                            Set Start Time
                          </button>
                          <button
                            onClick={() => setSettingTime('end')}
                            className={`px-4 py-2 rounded ${settingTime === 'end' ? 'bg-red-600' : 'bg-red-500'} text-white font-bold hover:bg-red-600`}
                          >
                            Set End Time
                          </button>
                        </div>
                        {settingTime && (
                          <p className="text-sm text-gray-600 mt-2">Click on the clock to set {settingTime} time</p>
                        )}
                        {startTime && (
                          <p className="text-sm text-green-600 mt-2">Start: {startTime.toLocaleTimeString()}</p>
                        )}
                        {endTime && (
                          <p className="text-sm text-red-600">End: {endTime.toLocaleTimeString()}</p>
                        )}
                      </div>
                    </div>
                  </div>
                  
                  <div className="bg-gray-50 rounded-lg p-6 mb-8">
                    <h2 className="text-2xl font-bold mb-4">Add Performer</h2>
                    <div className="flex gap-4">
                      <input
                        type="text"
                        placeholder="Performer name"
                        value={newPerformer.name}
                        onChange={(e) => setNewPerformer({...newPerformer, name: e.target.value})}
                        className="flex-1 px-4 py-2 border border-gray-300 rounded"
                        onKeyPress={(e) => e.key === 'Enter' && addPerformer()}
                      />
                      <select
                        value={newPerformer.instrument}
                        onChange={(e) => setNewPerformer({...newPerformer, instrument: e.target.value})}
                        className="px-4 py-2 border border-gray-300 rounded"
                      >
                        {instruments.map(inst => (
                          <option key={inst.name} value={inst.name}>{inst.name}</option>
                        ))}
                      </select>
                      <button
                        onClick={addPerformer}
                        className="px-6 py-2 bg-blue-500 text-white rounded font-bold hover:bg-blue-600"
                      >
                        Add to Queue
                      </button>
                    </div>
                  </div>
                </div>
                
                <div className="grid grid-cols-1 md:grid-cols-5 gap-6">
                  {instruments.map(instrument => {
                    const queue = performers[instrument.name];
                    const nextIdx = getNextPerformer(instrument.name);
                    
                    return (
                      <div key={instrument.name} className="bg-white rounded-lg shadow-lg overflow-hidden">
                        <div className={`${instrument.color} p-4 text-center`}>
                          <div className="text-4xl mb-2">{instrument.icon}</div>
                          <h3 className="text-xl font-bold">{instrument.name}</h3>
                          <button
                            onClick={() => toggleActive(instrument.name)}
                            className={`mt-3 px-4 py-2 rounded font-bold text-white ${
                              activePerformers[instrument.name] !== null ? 'bg-green-500' : 'bg-gray-400'
                            }`}
                          >
                            {activePerformers[instrument.name] !== null ? 'ACTIVE' : 'OFF'}
                          </button>
                        </div>
                        
                        <div className="p-4">
                          <h4 className="font-bold mb-2 text-gray-700">Queue & History:</h4>
                          <div className="space-y-2 max-h-96 overflow-y-auto">
                            {queue.map((performer, idx) => (
                              <div
                                key={performer.id}
                                className={`p-3 rounded border-2 ${
                                  performer.status === 'active' ? 'border-green-500 bg-green-50' :
                                  idx === nextIdx ? 'border-yellow-500 bg-yellow-50' :
                                  performer.status === 'finished' ? 'border-red-500 bg-red-50' :
                                  'border-gray-200'
                                }`}
                              >
                                <div className="flex items-center justify-between">
                                  <div>
                                    <div className="font-bold">{performer.name}</div>
                                    <div className="text-xs text-gray-600">
                                      Joined: {performer.entryTime.toLocaleTimeString()}
                                    </div>
                                    {performer.timeOnStage > 0 && (
                                      <div className="text-xs font-bold text-blue-600">
                                        Time on stage: {performer.timeOnStage} min
                                      </div>
                                    )}
                                  </div>
                                  <div className={`w-4 h-4 rounded-full ${getStatusColor(performer.status)}`}></div>
                                </div>
                              </div>
                            ))}
                            {queue.length === 0 && (
                              <p className="text-gray-400 text-center py-4">No performers yet</p>
                            )}
                          </div>
                        </div>
                      </div>
                    );
                  })}
                </div>
              </div>
            </div>
          );
        };

        ReactDOM.render(<JamSessionManager />, document.getElementById('root'));
    </script>
</body>
</html>